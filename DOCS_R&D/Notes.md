Лазерний CNC на Raspberry Pi 5
Цей проект описує складання та налаштування лазерного гравера/різака на базі Raspberry Pi 5, що керується контролером Arduino UNO із прошивкою GRBL (або опційно ESP32 з GRBL-ESP32). Документ призначений для новачка і містить повну інструкцію з необхідними командами, конфігураціями та ілюстраціями.
1. Необхідні комплектуючі
Raspberry Pi 5 (4 ГБ або 8 ГБ, 64-bit OS) – основний комп’ютер для інтерфейсу користувача (CNCjs, FlatCAM, Inkscape). Працює під Raspberry Pi OS 64-bit.
Arduino UNO – плата з мікроконтролером ATmega328P, на якій запускається прошивка GRBL для керування осями та лазером.
Arduino CNC Shield v3.0 – плата-розширення для Arduino Uno з роз’ємами для драйверів двигунів, кінцевиків, кнопок та керування шпинделем. Підтримує до 4-х осей (A-вісь опційно).
Stepper Drivers (A4988 або DRV8825) – драйвери крокових двигунів. Зазвичай A4988 (1.0–2.0 A), DRV8825 (2.2 A) для управління кроковими моторами по X, Y (Z). Забезпечують регулювання струму і мікрокроки (налаштовуються джамперами M0–M2).
Крокові мотори NEMA17 – мотори для осей. Приклад: NEMA17, 1.5–2.0 A на фазу, крок 1.8° (200 кроків/об). Суттєва потужність для переміщення платформи.
Концевики (кінцеві вимикачі) – мікровимикачі (або оптичні сенсори) для гомінгу та безпеки. Прикріплюються на X, Y, Z для визначення нульових положень. Підключаються до входів X-, X+, Y-, Y+, Z-, Z+ на CNC Shield.
Лазерний модуль (наприклад, 445 нм, 2.5–5.5 Вт) – лазер для гравіювання та різання. Має вбудований TTL-вхід (PWM/Analog) для регулювання потужності, а також живлення +12V та GND.
Драйвер лазера (якщо потрібно) – для потужніших лазерів може знадобитися зовнішній MOSFET-модуль або спеціалізований драйвер, що управляє струмом лазера.
Блок живлення 12V (10–20 A) – живить крокові двигуни і лазер. Наприклад, 12V/10A для невеликих лазерів; потужніший лазер вимагає більший струм. З’єднується з +V та GND на CNC Shield.
Кнопки керування – наприклад, аварійна зупинка (E-Stop), пауза, відновлення. Підключаються до відповідних контактів на CNC Shield (E-STOP, HOLD, RESUME), або реалізуються в графічному інтерфейсі.
Сенсорний дисплей 7″ для Raspberry Pi – наприклад, офіційний Raspberry Pi 7″ DSI-екран для місцевого управління. Підключається до порту DSI на Pi та живиться від 5V.
Рамна конструкція, кріплення, ремені/шестерні – механічна частина станка: вісі, направляючі, ремені HTD або гвинт/гайка тощо. (Деталі залежать від конкретної конструкції).
Кабелі та роз’єми – дроти для з’єднання двигунів, кінцевиків, блоків живлення. USB-кабель для Arduino, перемички для джамперів, шлейфи для сенсорного екрану.
Примітка: Усі компоненти мають відповідати один одному по напрузі та інтерфейсам. Вищевказані моделі є типовим прикладом комплекту.
2. Схема підключення GRBL


Рис.1: Arduino CNC Shield V3.0 з позначенням основних висновків (стрілка вказує на Z+ – PWM-вихід для лазера). На платі є роз’єми для двигунів X, Y, Z (та A осі), а також контакти для кінцевиків і управлінських сигналів. З’єднання компонентів (на прикладі CNC Shield v3.0 і лазера):
Крокові двигуни: Встановіть драйвери A4988/DRV8825 у слоти X, Y, Z на CNC Shield (і A, якщо є четверта вісь). Розташуйте драйвери правильно (позначено на платі). Налаштуйте джамперами M0–M2 бажаний мікрокрок (наприклад, 1/8 чи 1/16).
Потім під’єднайте моторні дроти до клем на роз’ємах X, Y, Z (чи A) відповідно. Забезпечте правильне чергування фаз (зазвичай позначено білою точкою на кабелі).
Кінцеві вимикачі: Підключіть кінцевики кожної осі між GND та вхідними контактами X-, Y-, Z- (та/або X+, Y+, Z+) на CNC Shield. Типово використовують контакти X-, Y-, Z- для механічних концевиків. Якщо потрібно, можна використати X+, Y+, Z+ для додаткових датчиків або керування лазером (див. нижче).
Лазерний модуль: Підключіть живлення лазера до +12V і GND від блоку живлення (аж до +V і GND на shield). Що стосується контролю потужності, під’єднайте TTL/PWM-контроль лазера до спеціального висновку на CNC Shield. У платі v3.0 нашішенку Z+ (пін Pin11 на Arduino) використовують для ШІМ керування лазером​
github.com
. Тобто, жовтий (або зелений) кабель управління лазером під’єднуємо до контакту Z+ на shield. Зауваження: у GRBL 1.1 шпиндельний вихід було перенесено – тепер пін Arduino D11 відповідає за змінну потужність шпинделя (лазера), а D12 – за концевик Z​
github.com
. Тому Z+ на платі практично “витягнуто” на D11 для ШІМ.
Кнопки керування: Для кнопки аварійної зупинки (E-Stop) використовуйте вивід E-STOP на платі CNC Shield. Кнопка повинна розривати живлення (або подавати сигнал на E-STOP). Кнопки “Hold” (пауза) та “Resume” (продовження) можна підключити до висновків HOLD і RESUME відповідно. При активації HOLD GRBL ставить машину на паузу, RESUME знімає паузу.
Живлення: Під’єднайте до плати CNC Shield високопотужний блок живлення +12V на клеми +V і GND. Цей же блок має живити двигуни та лазер. Важливо: поділити лише повне +12V – не треба проводити окремо +12 для двигунів і лазера (крім випадку з окремими блоками). Наприклад, чорний і червоний провід лазера під’єднуються до +V і GND, як і двигуни. 
github.com
Сенсорний екран: Підключіть сенсорний дисплей до Raspberry Pi через шлейф DSI. Зазвичай до контролера дисплею підводять 5V і GND (через спеціальний роз’єм або дроти). Згідно з інструкцією, червоний (+5V) провід дисплея з’єднати з 5V на Pi, чорний – з GND​
thepihut.com
. (Білі/червоні шлейфи на зображенні [14†L672-L680] демонструють це). Сенсорні сигнали передаються через DSI/USB-шину дисплею.
Ці з’єднання забезпечують коректну роботу GRBL: Arduino отримує команди з Raspberry Pi через USB, а через CNC Shield подає сигнал STEP/DIR на драйвери двигунів та PWM для лазера (на Pin11 через контакти Z+​
github.com
).
3. Налаштування GRBL
На Arduino UNO встановлюється прошивка GRBL 1.1 (або новіша). Після компіляції/завантаження рекомендується перевірити налаштування параметрів GRBL:
Кроки на мм ($100–$102): залежно від механіки. Наприклад, для білого ременя 16-зубчастого і моторів 200 кроків/об: $100=80.000 (X), $101=80.000 (Y) для 1/8 мікрокроків. Z-вісь залежить від приводу (гвинт-гайка тощо).
Макс. швидкості ($110–$112): наприклад, $110=1000.0 (мм/хв, X), $111=1000.0 (Y), $112=500.0 (Z).
Прискорення ($120–$122): наприклад, $120=50.0, $121=50.0, $122=20.0 (мм/с²).
Крайні координати ($130–$132): робочий хід: $130=200.0 (X), $131=200.0 (Y), $132=50.0 (Z), підлаштувати під фізичні розміри.
Режим лазера ($32, $30, $31): Обов’язково встановити $32=1 (лазерний режим включений)​
github.com
. Це означає, що на швидкостях переміщення G0 лазер вимикається, а під час робіт (G1/G2/G3) інтенсивність змінюється командою M3 S<value>. Так, налаштування $30 задає максимальну одиницю потужності. Наприклад, $30=1000 зробить так, що команда M3 S1000 увімкне лазер на 100% потужності, а M3 S500 – на 50%​
github.com
. $31 мінімальне значення (зазвичай 0).
Прочі налаштування: $1 (час імпульсу STEP) зазвичай 10 мкс, $20=1 (soft limits), $21=1 (hard limits ввімкнено для концевиків), $22=1 (homing), $23=3 (режим руху на гомінг), тощо. Ці параметри задаються залежно від потреб: рекомендується включити софт-ліміти та гомінг, якщо є концевики.
Для кастомних прошивок GRBL-ESP32 аналогічні параметри встановлюються через серійний порт (або веб-інтерфейс, якщо він є). У конфігураційному файлі config.h (GRBL Arduino) чи відповідних файлах для ESP32 слід перевірити пін лазера (інколи LASER_FIRE_PIN) і увімкнення лазерного режиму. Зазвичай, досить у GRBL v1.1 просто виконати $32=1​
github.com
 – додаткових змін в config.h робити не потрібно. Важливо також перевірити, що використовується правильна частота PWM (за замовчуванням на D11 ~31 кГц). Джерело: Офіційна документація GRBL на GitHub та приклад конфігурації лазера​
github.com
​
github.com
.
4. Прошивка GRBL на Arduino UNO та ESP32
GRBL на Arduino UNO:
Завантажте та встановіть Arduino IDE (версія 1.8+).
Якщо раніше була встановлена інша версія GRBL (як бібліотека), її варто видалити: у Arduino IDE перевірте, чи є в File → Examples приклад grblUpload. Якщо є, знайдіть папку бібліотеки GRBL (libraries/grbl у папці Arduino) і видаліть її, щоб уникнути конфліктів​
circuitist.com
.
Скачайте останню версію GRBL (напр. zipping з gnea/grbl на GitHub).
Розпакуйте архів, відкрийте Arduino IDE і зайдіть в File → Examples → grbl → grblUpload. У цьому відкритому прикладі просто натисніть Upload, попередньо обравши плату Arduino/Genuino Uno і відповідний COM-порт. IDE відкомпілює GRBL і прош’є Arduino​
circuitist.com
.
Після успішної прошивки контролер GRBL готовий до роботи.
GRBL-ESP32:
Встановіть Visual Studio Code і плагін PlatformIO (або Arduino IDE з налаштуваннями для ESP32).
Клонувати репозиторій GRBL-ESP32 (наприклад, Neoolog/GRBL-ESP32).
В PlatformIO оберіть плату ESP32 (наприклад, Espressif ESP32 Dev Module).
За потреби сконфігуруйте config.h (вказати кількість осей, призначення пінів, ввімкнення SPIFFS/SD, налаштування Wi-Fi тощо). Для лазера переконайтесь, що LASER_FIRE_PIN (якщо є) або PWM-пін встановлені правильно.
Під’єднайте ESP32 через USB, натисніть Upload – прошивка завантажиться на плату. Після цього ESP32 з GRBL-ESP32 може працювати як контролер: через серійний інтерфейс або Wi-Fi (в залежності від налаштувань).
Порада: Зазвичай для початку можна не використовувати Wi-Fi, а просто під’єднати ESP32 кабелем до Raspberry Pi і працювати через CNCjs по COM-порту. Якщо ж потрібен бездротовий зв’язок, налаштуйте Wi-Fi в прошивці GRBL-ESP32.
5. Налаштування Raspberry Pi 5 (64-bit)
Після складання апаратної частини налаштуйте Raspberry Pi 5 під управління CNC. Припускаємо, що встановлено Raspberry Pi OS 64-bit (Bullseye/Bookworm тощо).
Оновлення системи:
sudo apt-get update
sudo apt-get upgrade -y
sudo apt-get dist-upgrade -y
sudo apt-get install -y build-essential git
Ці команди оновлять пакети та встановлять необхідні інструменти​
cnc.js.org
. (За потреби можна також виконати sudo rpi-update, але це не обов’язково на стабільній ОС.)
Node.js і CNCjs:
Рекомендується встановити LTS-версію Node.js (наприклад, Node 18 або 20) через NodeSource або NVM. Один зі способів:
curl -fsSL https://deb.nodesource.com/setup_lts.x | sudo -E bash -
sudo apt-get install -y nodejs
Потім встановіть CNCjs глобально (не від root, щоб уникнути проблем з serialport):
npm install -g cncjs
Якщо використовуєте sudo npm install, додайте --unsafe-perm​
cnc.js.org
:
sudo npm install --unsafe-perm -g cncjs
Після встановлення перевірте версію: cnc -V.
Автозапуск CNCjs:
Щоб сервер CNCjs запускався автоматично, можна скористатися PM2 або системним сервісом. Наприклад, з PM2:
npm install -g pm2
pm2 start /usr/bin/cnc --name cncjs -- -p 8000
pm2 save
pm2 startup
(Або створіть systemd-сервіс з викликом cnc -p 8000 при старті.)
FlatCAM:
FlatCAM – це програма для підготовки траєкторій (зазвичай для PCB, але можна використовувати і для контурів). Її stable-релізи можна встановити через pip:
sudo apt-get install -y python3-pip python3-pyqt5 python3-shapely
pip3 install --upgrade FlatCAM
Або скористайтеся офіційними інструкціями FlatCAM (можливо, є пакети для Debian). Впевніться, що версія FlatCAM актуальна (найновіша 8.x/9.x станом на 2025 рік). FlatCAM працює на Python3 і потребує PyQt5/PyQt6, Shapely тощо.
Inkscape:
Для створення векторної графіки встановіть Inkscape (версія 1.2+). У Raspberry Pi OS він доступний через apt:
sudo apt-get install -y inkscape
За бажанням можна встановити новішу версію з офіційних пакетів чи Snap. Inkscape знадобиться для конвертації растрових зображень або малювання векторів.
Сенсорний екран:
Підключіть ribbon-кабель від екрану до порту DSI на Raspberry Pi (як показано в інструкції по збиранню екрану​
thepihut.com
​
thepihut.com
).
Під’єднайте живлення дисплея: два дроти – червоний (+5V) та чорний (GND) – з GPIO Pi відповідно (3-й і 4-й контакти з торця GPIO)​
thepihut.com
.
Упевніться, що екран має оновлену прошивку: після підключення запустіть Pi і оновіть ОС (sudo apt-get update && sudo apt-get full-upgrade​
thepihut.com
).
За потреби виконайте калібрування сенсора: встановіть пакет xinput-calibrator або використайте вбудоване калібрування в Raspberry Pi OS.
У raspi-config (GUI→Advanced Options→Resolution або Display options) встановіть оптимальне роздільна здатність/орієнтацію. Для 7″ екрану 800×480 зазвичай вистачає.
Після цих кроків на Pi буде встановлено середовище CNC: сервер CNCjs, FlatCAM, Inkscape, а також доступна робоча станція через сенсорний екран (або клавіатуру/мишку).
6. Приклад робочого процесу
Покроковий приклад: створення гравірування малюнка.
Підготовка зображення в Inkscape:
Намалюйте або імпортуйте растрове зображення в Inkscape. Перетворіть його в вектор: якщо зображення – растрове, використайте Path → Trace Bitmap для векторизації.
Оптимізуйте криві (видаліть зайві вузли), встановіть товщину ліній та колір (чорні контури, білі заповнення).
Збережіть файл у форматі SVG (Inkscape) або експортуйте в DXF (File → Save As → AutoCAD DXF) для подальшої обробки.
Обробка в FlatCAM:
Запустіть FlatCAM і відкрийте там збережений SVG/DXF. Інтерпретуйте контур як різак (milling) або контур гравера.
Встановіть параметри інструмента: товщину різу (наприклад, фреза 0.1 мм або лазер), швидкість подачі, глибину тощо. Для лазера в FlatCAM можна просто створити одиничну траєкторію по контуру (таб Tool).
Згенеруйте G-code (чи в FlatCAM, чи експортуйте через G-code генератор). Переконайтеся, що формат G-code сумісний з GRBL (стандарт G0/G1, M3/M5 для лазера). FlatCAM створить gcode-файл.
Запуск через CNCjs:
Підключіть Arduino (або ESP32) через USB до Raspberry Pi. У CNCjs оберіть правильний серійний порт (наприклад, /dev/ttyACM0 для Arduino) і швидкість 115200 (за замовчуванням GRBL).
У CNCjs завантажте згенерований gcode-файл. Ви побачите траєкторію руху. У налаштуваннях CNCjs можна увімкнути лазерний режим (натиснути іконку з лазером) або вручну використовувати M3/M5.
Перед запуском обнуліть координати (G28 або скористайтесь гомінг-циклами $H, якщо було зроблено). Помістіть вказівник (лазер або інструмент) у початковий (абсолютний) нуль (зазвичай один з кутів чи центр).
Натисніть Play. CNCjs поступово відправляє команди, Arduino керує осями, а лазер вмикається командою M3 (потужність задано командами S у gcode). Після завершення програми подайте M5 (лазер вимкнено).
Налаштування потужності та швидкості:
Якщо лазер дуже потужний, розділіть процес: наприклад, перший прогін з меншим S (потужністю) для обведення, другий – повна глибина.
Слідкуйте за вказівками безпеки: завжди користуйтесь захисними окулярами для відповідної довжини хвилі і перевіряйте, що в кімнаті немає відблисків.
Цей простий робочий процес ілюструє: Inkscape → FlatCAM → CNCjs. Кожна програма відповідає за свій етап: проектування, розрахунок траєкторій, відправка на машину.
7. (Опційно) Python+Qt6 контролер
Як альтернативу CNCjs можна використовувати самописні або існуючі додатки на Python з графічним інтерфейсом (наприклад, PyQt6). Такі програми можуть підключатися до GRBL через послідовний порт та відправляти ті ж G-коди. Перевага – гнучкість інтерфейсу та можливість додати специфічні опції. Приклад: ви можете створити PyQt6-застосунок, який надає кнопки Start/Pause, відображає стан датчиків і дозволяє регулювати потужність лазера слайдером. Для підключення до GRBL достатньо використовувати бібліотеку pyserial. Деякі користувачі використовують готові програми (бібліотеки) для Grbl, або розробляють власні GUI. Такий додатковий розділ може бути опцією для просунутих користувачів DIY-набору.
Висновки
Представлена інструкція містить повний перелік компонентів, схему підключення, налаштування прошивки GRBL (Arduino та ESP32), налаштування Raspberry Pi 5 та приклад робочого процесу для лазерного гравування. Цей README.md покликаний слугувати стартовим посібником для створення власного DIY CNC лазерного гравера/різака на базі Raspberry Pi та Arduino з GRBL, і може бути адаптований під конкретні набори та модулі.

$X             
G21           
G90            
G0 X0 Y0 F3000 
G1 X100 F1000  
G1 Y100 F1000 
G1 X0 Y0 F1000 

🔥 1. Що ріже лазер S1000 (макс. потужність)?
У тебе модуль:
AENBUSLM 40W (оптична ≈ 5–5.5 Вт), 24V, PWM 0–5V
З цим лазером на максимумі (S1000) реально:
| Матеріал               | Товщина     | Результат                       |
| ---------------------- | ----------- | ------------------------------- |
| **Фанера**             | 2–4 мм      | Ріже за 1–3 проходи             |
| **Акрил (чорний)**     | 2–3 мм      | Ріже, інші кольори — складно    |
| **Картон, шкіра**      | 1–3 мм      | Швидко                          |
| **Папір, тканина**     | <1 мм       | Легко                           |
| **Пластик (типу ABS)** | 1–2 мм      | Різка + дим/запах (вентиляція!) |
| **PCB (FR4, чорне)**   | верхній шар | Гравірування з охолодженням     |


🟡 2. Яке значення S для гравіювання?
Все залежить від:
Матеріалу
Контрасту, який ти хочеш
Швидкості (F)
Орієнтовні значення:
| Матеріал       | Потужність (S) | Швидкість (F) | Примітка      |
| -------------- | -------------- | ------------- | ------------- |
| Фанера         | 300–600        | 1000–2000     | Сіре/темне    |
| Картон         | 150–400        | 1000–3000     |               |
| Шкіра          | 400–600        | 1000–1500     | Пахне, димить |
| Папір          | 100–200        | 2000–3000     | Обережно!     |
| MDF            | 400–700        | 800–1500      |               |
| Анод. алюміній | 600–1000       | 500–1500      | Контраст ч/б  |

Сталь, мідь, алюміній — НЕ ріже, лише маркування (з попереднім чорнінням).

